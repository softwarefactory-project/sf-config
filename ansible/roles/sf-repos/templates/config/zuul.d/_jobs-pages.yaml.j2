# This file is managed by ansible, do not edit directly
---
{% if zuul_gerrit_connections or zuul_github_connections or zuul_pagure_connections or (tenant_deployment and config_key_exists) %}
- job:
    name: build-and-publish-pages
    parent: base
    description: Base build and publish pages job
    run: playbooks/pages/build.yaml
    post-run:
      - playbooks/pages/publish.yaml
    secrets:
      - site_pages
{% if pages_nodeset is defined %}
    nodeset:
      nodes:
        - name: builder
          label: {{ pages_nodeset }}
{% endif %}
    protected: true
    vars:
      src_dir: /
      fqdn: {{ fqdn }}

- job:
    name: build-pages
    parent: base
    description: Pages build
    run: playbooks/pages/build.yaml
{% if pages_nodeset is defined %}
    nodeset:
      nodes:
        - name: builder
          label: {{ pages_nodeset }}
{% endif %}
    vars:
      src_dir: /

{% endif %}
