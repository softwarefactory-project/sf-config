[gearman]
server={{ zuul3_scheduler_host }}
check_job_registration=true

[gearman_server]
start=true
log_config=/etc/zuul/gearman-logging.conf

[webapp]
listen_address=0.0.0.0
port={{ zuul3_webapp_port }}

[zuul]
tenant_config=/etc/zuul/main.yaml
log_config=/etc/zuul/scheduler-logging.conf
pidfile=/var/run/zuul/zuul.pid
state_dir=/var/lib/zuul
status_url={{ zuul3_pub_url }}
zookeeper_hosts={{ zookeeper_host }}:2181
job_name_in_report=true
report_times=true
url_pattern=https://{{ fqdn }}/logs/{build.parameters[LOG_PATH]}

[merger]
git_dir=/var/lib/zuul/git
git_user_email=zuul@{{ fqdn }}
git_user_name=zuul
zuul_url={{ zuul3_pub_url }}p
log_config=/etc/zuul/merger-logging.conf
append_hostname=true

[executor]
git_dir=/var/lib/zuul/executor/
log_config=/etc/zuul/executor-logging.conf
finger_port=7979

[connection sqlreporter]
driver=sql
dburi=mysql+pymysql://{{ zuul3_mysql_user }}:{{ zuul3_mysql_password}}@{{ zuul3_mysql_host }}/{{ zuul3_mysql_db }}

[connection gerrit]
driver=gerrit
server=gerrit.{{ fqdn }}
# baseurl is only use to fetch git refs on diff url than server.
# Using baseurl we cannot modify url zuul report to user
baseurl={{ gerrit_pub_url }}
user=zuul
sshkey=/var/lib/zuul/.ssh/id_rsa

{% for conn in gerrit_connections %}{% if "disabled" not in conn or not conn["disabled"] %}
[connection {{ conn['name'] }}]
driver=gerrit
server={{ conn['hostname'] }}
baseurl={{ conn['puburl'] }}
user={{ conn['username'] }}
sshkey=/var/lib/zuul/.ssh/id_rsa

{% endif %}{% endfor %}

[connection smtp]
driver=smtp
server=localhost
port=25
default_from=zuul@{{ fqdn }}
default_to=admin@{{ fqdn }}
