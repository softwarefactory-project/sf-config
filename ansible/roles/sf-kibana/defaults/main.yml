---
role_actions:
  - install
  - setup
  - backup
  - restore
  - configure_mirror
  - postconf
  - disable

role_package: kibana

elk_stack_version: 7
elk_sub_version: 8

opendistro_repos_name: elasticsearch-6.x,elasticsearch-7.x,opendistroforelasticsearch-artifacts
opendistro_version: 1.9.0
opendistro_repos:
  - name: elasticsearch-6.x
    desc: Elasticsearch repository for 6.x packages
    url: https://artifacts.elastic.co/packages/oss-6.x/yum
    gpgkey: https://artifacts.elastic.co/GPG-KEY-elasticsearch
    gpgcheck: 1
  - name: elasticsearch-7.x
    desc: Elasticsearch repository for 7.x packages
    url: https://artifacts.elastic.co/packages/oss-7.x/yum
    gpgkey: https://artifacts.elastic.co/GPG-KEY-elasticsearch
    gpgcheck: 1
  - name: opendistroforelasticsearch-artifacts
    desc: Release RPM artifacts of OpenDistroForElasticsearch
    url: https://d3g5vo6xdbdb9a.cloudfront.net/yum/noarch/
    gpgkey: https://d3g5vo6xdbdb9a.cloudfront.net/GPG-KEY-opendistroforelasticsearch
    gpgcheck: 1

elasticsearch_http_port: 9200
elasticsearch_host: elasticsearch.example.com
elasticsearch_internal_url: "https://{{ elasticsearch_host }}:{{ elasticsearch_http_port }}"

elasticsearch:
  kibanaserver_password: kibanaserver
  readonly_user: kibana
  readonly_password: kibana

kibana_http_port: 5601
kibana_host: kibana.example.com
kibana_internal_url: "http://{{ kibana_host }}:{{ kibana_http_port }}"

# FIXME: change readonly user and password
kibana_bundle_js_patch: |
  function isReady() {
    return (document.getElementsByClassName("euiHeader").length > 0 ||
            document.getElementsByClassName("euiGlobalToastList").length > 0);
  }
  function injectTopMenu() {
  if (!isReady()) {
    setTimeout(injectTopMenu, 500);
  }
  newScript = document.createElement('script');
  newScript.type = 'text/javascript';
  newScript.src = '/static/js/topmenu.js';
  newScript.onload = function() {
    loadTopmenu();
  };
  document.getElementsByTagName('head')[0].appendChild(newScript);
  document.getElementsByClassName("login-subtitle")[0].textContent = "Readonly user: {{ elasticsearch['readonly_user'] }} password: {{ elasticsearch['readonly_password'] }}"
  }
  injectTopMenu()

kibana_style_css_patch: |
  /* sf loadTopmenu */
  body .euiHeader {
    position: absolute;
    margin-top: 50px;
  }
  .euiBody--headerIsFixed {
    all: unset;
  }
  .euiPage {
    margin-top: 100px;
  }
  .globalQueryBar {
    padding-top: 60px !important;
  }
  iframe{
    height:50px;
    position:absolute;
    z-index: 99999;
  }
  /* Fixing visualization/dashboard save navbar */
  .kbnTopNavMenu {
    padding-top: 110px !important;
  }

  .globalQueryBar{
    all: unset;
  }
