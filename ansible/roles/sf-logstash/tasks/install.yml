---
- name: Install requirements
  yum:
    name: java-1.8.0-openjdk
    state: present
    disablerepo: "{{ yum_disable_repo|default(omit) }}"
    enablerepo: "{{ yum_enable_repo|default(omit) }}"

- name: Install logstash package
  yum:
    name: logstash
    state: present
    disablerepo: "*"
    enablerepo: "{{ elasticsearch_repo_name }}"

- include_tasks: "{{ sf_tasks_dir }}/check_version.yml"

- name: Get logstash version
  command: grep -oE '[0-9]' /var/lib/software-factory/versions/sf-logstash  | head -n 1
  register: logstash_version

- include_tasks: bump_version.yml
  when: logstash_version.stdout < 5
