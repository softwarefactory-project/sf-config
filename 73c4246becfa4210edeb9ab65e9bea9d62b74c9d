{
  "comments": [
    {
      "key": {
        "uuid": "a3b1dc24_51107480",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 6
      },
      "writtenOn": "2019-03-11T13:04:45Z",
      "side": 1,
      "message": "If you need specific groups in config_repo_acl then you probably need to make that block configurable too.",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "9954de2f_d7eb9436",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 7
      },
      "writtenOn": "2019-03-11T14:03:46Z",
      "side": 1,
      "message": "How about we remove that part? IIRC it\u0027s just there because managesf won\u0027t create the project if the acl are referencing unknown group. Could we make it create default empty group for that special case instead?",
      "parentUuid": "a3b1dc24_51107480",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "47b4c943_e32258d9",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 533
      },
      "writtenOn": "2019-03-11T14:58:32Z",
      "side": 1,
      "message": "What I\u0027ve found is this config block does not exist in a bootstrapped SF install. Once SF has finished installing, this block exists in the resources.yaml not the _internal.yaml. I think this block is here (inside the {% if initial_creation %} block because this template is also sent to managesf to initialize the config project?",
      "parentUuid": "9954de2f_d7eb9436",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "5404d35b_b8fe592f",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 7
      },
      "writtenOn": "2019-03-12T01:10:06Z",
      "side": 1,
      "message": "Yes, sfconfig manually uses this file with managesf to create the repository (and the resources engine would fail if the acl reference missing groups). I think we could manage those initial groups definitions differently. Either by appending them before the initial submission, or by letting managesf creates empty groups when missing from the resources, at least for that bootstrap step.",
      "parentUuid": "47b4c943_e32258d9",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "ac2a47f3_cc2daab9",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 533
      },
      "writtenOn": "2019-03-12T01:24:54Z",
      "side": 1,
      "message": "Gotcha.. is that related to this change? I\u0027m not sure if that should be done as part of this commit or what to do exactly. Thanks",
      "parentUuid": "5404d35b_b8fe592f",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "461aae31_efe323b5",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 7
      },
      "writtenOn": "2019-03-12T02:00:15Z",
      "side": 1,
      "message": "it\u0027s kind of related because we need to ensure config_repo_acl.groups is synced with that list. Though I think we could remove that initial_create cruft and handle that chicken-and-egg problem differently. Thus if that config_repo_acl custom vars works for you, it seems like we could keep that change as-is and follow-up with a cleanup. Fabien, what do you think?",
      "parentUuid": "ac2a47f3_cc2daab9",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "c563fbde_9c94cabd",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 6
      },
      "writtenOn": "2019-03-12T11:07:03Z",
      "side": 1,
      "message": "I think we should move the config-acl in resources.yaml.j2 that way after bootstrap it will be possible to change the config-acl and related groups w/o the changes be wiped/restored by sfconfig. It will give more flexibility and also thanks to config-check job it will help the operator to not make format mistakes by setting by hands w/o verification the acl prior to sfconfig run.\n\nIn that case we can remove the initial creation logic and instead find a solution to provide a /var/lib/software-factory/bootstrap-data/resources.yaml to managesf-resources direct-apply that contains _internal.yaml + resources.yaml.\n\nDoes it make sense ? and can it matches your needs Logan ?",
      "parentUuid": "461aae31_efe323b5",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "54d5e278_04cd6cf1",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 533
      },
      "writtenOn": "2019-03-12T14:41:30Z",
      "side": 1,
      "message": "Fabien: As far as I understand it, that is already the case. I think this block is only used during bootstrapping.\n\nOnce you install with sfconfig, this block is NOT in the config repo\u0027s _internal.yaml, it is in the resources.yaml and can be user edited without being clobbered by sfconfig.\n\nIt seems counter-intuitive seeing this block here, but I just bootstrapped a couple SF installs to test things this week, so I am just speaking from what I saw in the deployed config repo.",
      "parentUuid": "c563fbde_9c94cabd",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "431eea2b_897b9bc1",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 6
      },
      "writtenOn": "2019-03-12T15:03:54Z",
      "side": 1,
      "message": "\u003e Fabien: As far as I understand it, that is already the case. I\n \u003e think this block is only used during bootstrapping.\n \nYes, what I mean is I think the config-acl should be moved in resources.yaml.j2 that way both config-acl and config\u0027s group are in config/resources/resources.yaml and can be safely edited in the config repo. Then no need to define config_repo_acl.*.\n \n \u003e Once you install with sfconfig, this block is NOT in the config\n \u003e repo\u0027s _internal.yaml, it is in the resources.yaml and can be user\n \u003e edited without being clobbered by sfconfig.\n \u003e \n \u003e It seems counter-intuitive seeing this block here, but I just\n \u003e bootstrapped a couple SF installs to test things this week, so I am\n \u003e just speaking from what I saw in the deployed config repo.\n\nYes agree and at boostraping we should manage to have direct-apply called with a temp file (_internal.yaml + resources.yaml).",
      "parentUuid": "54d5e278_04cd6cf1",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "e2c04d6c_9cdbae28",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 533
      },
      "writtenOn": "2019-03-12T15:11:49Z",
      "side": 1,
      "message": "Done in https://softwarefactory-project.io/r/#/c/15201/",
      "parentUuid": "431eea2b_897b9bc1",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "05bf1372_986b216f",
        "filename": "ansible/roles/sf-repos/templates/config/resources/_internal.yaml.j2",
        "patchSetId": 3
      },
      "lineNbr": 81,
      "author": {
        "id": 6
      },
      "writtenOn": "2019-03-12T20:24:21Z",
      "side": 1,
      "message": "Logan, I\u0027m fine with the change. Tristan we should discuss a followup change to make the config-acl alterable in the config repo imo.",
      "parentUuid": "e2c04d6c_9cdbae28",
      "range": {
        "startLine": 75,
        "startChar": 0,
        "endLine": 81,
        "endChar": 17
      },
      "revId": "73c4246becfa4210edeb9ab65e9bea9d62b74c9d",
      "serverId": "6c1dc8ef-8b94-40e4-bd83-c2359d45ecc0",
      "unresolved": false
    }
  ]
}